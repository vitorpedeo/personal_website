---
slug: simple-page-transitions-in-nextjs-with-framer-motion
title: Transições de Páginas Simples no Next.js com Framer Motion
excerpt: Transições de páginas podem ser facilmente implementadas com o Framer Motion.
publishedAt: "2022-02-03"
tags: [Front End, Next.js]
---

Animações e transições são bons artifícios para manter os usuários entretidos enquanto usam um software,
e é por isso que existem vários pacotes cujo principal objetivo é facilitar a implementação dos itens citados. Nesse tutorial, eu irei utilizar o [Framer Motion](https://www.framer.com/docs/) que é, na minha opinião, um dos melhores pacotes para lidar com animações (e transições).

Duas coisas antes de iniciarmos:
- Irei assumir que você tem conhecimento básico em React e Next.js;
- Esse tutorial está usando o [Typescript](https://www.typescriptlang.org/),
o [Visual Studio Code](https://code.visualstudio.com/) como editor de texto e o
[yarn](https://yarnpkg.com/) como o gerenciador de pacotes.

Chega de conversa, bora lá!

## Resultado final

<PostImage
  src="/images/posts/simple-page-transitions-in-nextjs-with-framer-motion/final.gif"
  alt="GIF containing final result"
/>

## Inicialização do projeto

Antes de tudo, inicie um projeto Next.js.

<CodeBlock language="bash">
{`yarn create next-app page-transitions-demo --ts`}
</CodeBlock>

Depois, vá para a raiz do projeto e instale o pacote <InlineCode>framer-motion</InlineCode>.

<CodeBlock language="bash">
{`cd page-transitions-demo`}
</CodeBlock>

<CodeBlock language="bash">
{`yarn add framer-motion`}
</CodeBlock>

Por fim, abra o projeto no VSCode.

<CodeBlock language="bash">
{`code .`}
</CodeBlock>

A raiz do seu projeto iniciará com as seguintes pastas:
- node_modules
- pages
- public
- styles

Para uma melhor organização do nosso projeto, apague a pasta <InlineCode>styles</InlineCode>,
crie uma pasta chamada <InlineCode>src</InlineCode> e mova a pasta <InlineCode>pages</InlineCode>
para dentro dela. Agora, a raiz do seu projeto estará assim:
- node_modules
- public
- src
  - pages

Vamos limpar alguns arquivos do projeto. Dentro da pasta <InlineCode>src</InlineCode>, apague a pasta <InlineCode>api</InlineCode>. Após isso, selecione o arquivo <InlineCode>index.tsx</InlineCode> e cole o seguinte código nele:

<CodeBlock language="tsx">
{`export default function Home() {
  return (
    <div>
      <h1>Home</h1>
    </div>
  );
}`}
</CodeBlock>

## Criando as transições

Ok, existe apenas um arquivo que ainda não modificamos: <InlineCode>_app.tsx</InlineCode>. Temos uma razão para isso, ele será nosso **principal arquivo** nesse tutorial. Ele irá conter a lógica das transições do <InlineCode>framer-motion</InlineCode>.

Dentro do arquivo <InlineCode>_app.tsx</InlineCode>, nosso primeiro passo é importar o componente <InlineCode>motion</InlineCode>.

<CodeBlock language="tsx">
{`import { motion } from 'framer-motion';`}
</CodeBlock>

Como a documentação do <InlineCode>framer-motion</InlineCode> explica, o componente <InlineCode>motion</InlineCode> é **o núcleo da API Motion**. Ele possui componentes para todos os elementos HTML e SVG, porém nós iremos usar apenas a <InlineCode>div</InlineCode> nesse tutorial.

Agora, coloque seu <InlineCode>Component</InlineCode> dentro do componente <InlineCode>motion.div</InlineCode>.

<CodeBlock language="tsx">
{`<motion.div>
  <Component {...pageProps} />
</motion.div>`}
</CodeBlock>

Vamos adicionar duas props no componente <InlineCode>motion.div</InlineCode>: <InlineCode>initial</InlineCode> e <InlineCode>animate</InlineCode>.

<CodeBlock language="tsx">
{`<motion.div
  initial="initial"
  animate="animate"
>
  <Component {...pageProps} />
</motion.div>`}
</CodeBlock>

Como o nome indica, a prop <InlineCode>initial</InlineCode> refere-se ao estado inicial da animação do nosso componente. A prop <InlineCode>animate</InlineCode> refere-se ao estado final da animação do nosso componente. Eu usei nomes mais simples só para ser mais claro, no entanto você pode escolher qualquer nome que você desejar.

Essas duas props são insuficientes para o nosso objetivo, por isso vamos adicionar mais uma prop: <InlineCode>variants</InlineCode>.

<CodeBlock language="tsx">
{`<motion.div
  initial="initial"
  animate="animate"
  variants={
    initial: {
      x: 300,
      opacity: 0,
    },
    animate: {
      x: 0,
      opacity: 1,
    },
  }
>
  <Component {...pageProps} />
</motion.div>`}
</CodeBlock>

Essa prop irá dizer ao <InlineCode>motion</InlineCode> como o nosso componente irá se comportar em seus estados inicial e final da animação. Eu decidi animar a posição e a opacidade das minhas páginas, mas você animar outras propriedades.

Por fim, nós precisamos informar um valor único para que o <InlineCode>motion</InlineCode> consiga identificar qual componente (no nosso caso, página) está sendo mostrado e animado atualmente. Para isso, nós podemos utilizar o caminho (URL) atual da página, já que ele é um valor único. Primeiro, pegue a prop <InlineCode>router</InlineCode> das props do App.

<CodeBlock language="tsx">
{`function MyApp({ Component, pageProps, router }: AppProps)`}
</CodeBlock>

Agora, vamos informar ao <InlineCode>motion.div</InlineCode> que a prop key irá receber o valor <InlineCode>router.asPath</InlineCode>.

<CodeBlock language="tsx">
{`key={router.asPath}`}
</CodeBlock>

Nosso <InlineCode>_app.tsx</InlineCode> ficará assim:

<CodeBlock language="tsx">
{`import { motion } from 'framer-motion';
import type { AppProps } from 'next/app';
function MyApp({ Component, pageProps, router }: AppProps) {
  return (
    <motion.div
      key={router.asPath}
      initial="initial"
      animate="animate"
      variants={{
        initial: {
          x: 300,
          opacity: 0,
        },
        animate: {
          x: 0,
          opacity: 1,
        },
      }}
    >
      <Component {...pageProps} />
    </motion.div>
  );
}
export default MyApp;`}
</CodeBlock>

Finalmente nossas transições de páginas foram implementadas! Para ver elas em ação, cole o seguinte código no arquivo <InlineCode>index.tsx</InlineCode>:

<CodeBlock language="tsx">
{`import Link from 'next/link';
export default function Home() {
  return (
    <div>
      <Link href="/about">About</Link>
      <h1>Home</h1>
    </div>
  );
}`}
</CodeBlock>

Depois, crie o arquivo <InlineCode>about.tsx</InlineCode> e cole o seguinte código:

<CodeBlock language="tsx">
{`import Link from 'next/link';
export default function About() {
  return (
    <div>
      <Link href="/">Home</Link>
      <h1>About</h1>
    </div>
  );
}`}
</CodeBlock>

Para testar, rode o comando:

<CodeBlock language="bash">
{`yarn dev`}
</CodeBlock>

Algumas sugestões:
- Mude o tipo da animação (por exemplo, uma animação que use a propriedade scale);
- Se você prestar atenção no GIF do resultado final, você irá perceber que a scrollbar horizontal está aparecendo e desaparecendo entre as animações. Tente arrumar isso! (Dica: <InlineCode>overflow-x</InlineCode>).

Isso é tudo, obrigado por ler até aqui!
